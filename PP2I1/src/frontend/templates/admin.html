<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" type="text/css" href="../static/css/admin.css"/>
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
		<title> Admin Page </title>
	</head>
	<body>
		<div class="map-container flex-row">
			<div class="column map" id="map"> </div>
			<div class="column locations-container flex-column">
				<h1 class="text-center">  Localisations des poubelles </h1>
				<div class="data-container flex-row">
					{% if bins_data == [] %}
					    {% block nobins %}
					        <p> Aucune poubelle n'a été enregistrée.</p>
					    {% endblock %}
					{% else %}
					    {% block content %}
                            {% for bin in bins_data %}
                                <div class="bin-entry" data-long="{{ bin.long }}" data-lat="{{ bin.lat}}">
                                    <div class="bin-entry-infos">
                                        <p> Volume utilisé : {{ bin.used }} </p>
                                        <p> Volume maximum : {{ bin.volume}} </p>
                                        <p> Dernier vidage : {{ bin.last_emptied }}</p>
                                        <p> Dernier vidage par : {{ bin.numberplate if bin.numberplate else "Jamais vidé" }} </p>
                                        <p> Type de déchet :  {{ bin.waste_type}}</p>
                                    </div>
                                    <div class="bin-entry-name">
                                        <p> {{ bin.last_name }}  {{ bin.first_name }}</p>
                                    </div>
                                </div>
                            {% endfor %}
					    {% endblock %}
					{% endif %}
				</div>
			</div>
		</div>
		<div class="grid-layout">
			<div class="div1 products-management flex-row">
				<div class="management-option selected-option" data-id="0">
					<p> Ajouter </p>
				</div>
				<div class="management-option" data-id="1">
					<p> Modifier </p>
				</div>
			</div>
			<div class="div2">
				<div class="form-wrapper">
					<h1 class="text-center" id="option-title"> Ajouter un produit : </h1>
					<form id="form-products" enctype="multipart/form-data" action="/admin/add-product/" class="flex-column" method="post">
						<div class="field-group">
							<label for="product-name" class="label"> Nom du produit : </label>
							<input class="input" type="text" name="product-name">
						</div>
						<div class="field-group">
							<label for="img" class="label">Sélectionnez une image : </label>
							<input onchange="previewImage(event)" accept="image/png,image/jpeg,image/jpg" type="file" id="file" name="img">
						</div>
						<div class="field-group">
							<label for="price" class="label"> Prix du produit : </label>
							<input class="input" type="text" name="price">
						</div>
						<div class="field-group">
							<label class="label" for="desc"> Description du produit : </label>
							<input class="input" type="text" name="desc" />
						</div>
						<div class="field-group">
							<label class="label" for="volume"> Volume de la poubelle : </label>
							<input class="input" type="text" name="volume" />
						</div>
						<div class="field-group">
							<label class="label" for="stock"> Stock : </label>
							<input class="input" type="text" name="stock"/>
						</div>
						<div class="field-group">
							<input class="btn-submit transition-duration-300" type="submit" value="Valider" />
						</div>
					</form>
				</div>
			</div>
			<div class="div3">
				<div id="add-preview" class="product-entry flex-row">
					<div class="product-entry-img">
						<img class="product-entry-img" src="./../static/images/products/lagrossedaronnedetom.png" alt="product-img"/>
					</div>
					<section class="itemInfo">
						<h2 class="itemName"> 
							<span class="fields"> Titre </span>
							- 
							<span class="fields"> Volume </span>
						</h2>
						<p class="itemDesc fields"> 
							Description
						</p>
					</section>
					<section class="itemBuying">
						<p class = "itemPrice fields"> Prix </p>
						<p> En stock : <span class="fields"> stock</span> </p>
						<button> Ajouter au panier </button>
					</section>
				</div>
				<div class="hidden select-product flex-column">
					{% if products == [] %}
					    <p> Aucun produit n'a été enregistré. </p>
					{% else %}
                        {% block products %}
                            {% for product in products %}
                                <div class="product-entry-container">
                                    <div class="product-entry flex-row" data-id="{{product.product_id}}">
                                        <div class="product-entry-img">
                                            <img src="./../static/images/products/{{ product.img_url }}" alt="product-img"/>
                                        </div>
                                        <section class="itemInfo">
                                            <h2 class="itemName"> 
                                                <span class="fields"> {{ product.name}} </span>
                                                - 
                                                <span class="fields"> {{product.volume}}L </span>
                                            </h2>
                                            <p class="itemDesc fields"> 
                                                {{ product.desc}} 
                                            </p>
                                        </section>
                                        <section class="itemBuying">
                                            <p class="itemPrice fields"> {{ product.price}}€ </p>
                                            <p> En stock : <span class="fields">  {{product.stock}} </span> </p>
                                            <button> Ajouter au panier </button>
                                        </section>
                                    </div>
                                    <div class="option-buttons" style="display: none;">
                                        <form method="post" action="/admin/delete/{{product.product_id}}">
                                            <div class="button cancel-selection">
                                                <img class="red-filter" src="./../static/images/cross.svg" class="cancel-selection" alt="button" style="width:20px;"></img>
                                            </div>
                                            <button class="button" name="delete-button" type="submit">
                                            <img class="red-filter" src="./../static/images/delete.svg" alt="delete button" style="width:20px;">
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endblock %}
					{% endif %}
				</div>
			</div>
		</div>
		<script type="text/javascript" src="./../static/js/map.js"></script>
		<script type="text/javascript" src="./../static/js/products_admin.js"></script>
		<script>
			{% for marker in bins_data %}
			    L.marker([{{ marker['lat'] }}, {{ marker['long'] }}]).addTo(map)
			    .bindPopup("{{ marker['last_name'] }} {{ marker['first_name'] }} ")
			{% endfor %}
		</script>
	</body>
</html>